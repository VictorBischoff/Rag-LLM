# Tox configuration for RAG-LLM project
# Run with: tox

[tox]
envlist = py310, py311, py312, lint, format, coverage
isolated_build = true
skip_missing_interpreters = true

[testenv]
deps =
    pytest>=8.3.4
    pytest-asyncio>=0.24.0
    pytest-cov>=6.0.0
    pytest-mock>=3.14.0
    pytest-httpserver>=1.0.11
    responses>=0.25.3
    requests-mock>=1.12.1
    freezegun>=1.5.5
    httpx>=0.28.1
    ruff>=0.1.0
commands =
    pytest {posargs}


[testenv:py310]
basepython = python3.10


[testenv:py311]
basepython = python3.11


[testenv:py312]
basepython = python3.12

[testenv:lint]
basepython = python3.10
deps = ruff>=0.1.0
commands =
    ruff check .
    ruff check --select I .

[testenv:format]
basepython = python3.10
deps = ruff>=0.1.0
commands =
    ruff format .
    ruff check --fix .

[testenv:coverage]
basepython = python3.10
deps = {[testenv]deps}
commands =
    pytest --cov=. --cov-report=term-missing --cov-fail-under=80 {posargs}

[testenv:slow]
basepython = python3.10
deps = {[testenv]deps}
commands =
    pytest -m "not gpu" {posargs}

[testenv:integration]
basepython = python3.10
deps = {[testenv]deps}
commands =
    pytest tests/integration/ -m "integration" {posargs}

[testenv:e2e]
basepython = python3.10
deps = {[testenv]deps}
commands =
    pytest tests/e2e/ -m "e2e" {posargs}

[testenv:unit]
basepython = python3.10
deps = {[testenv]deps}
commands =
    pytest tests/unit/ -m "unit" {posargs}
